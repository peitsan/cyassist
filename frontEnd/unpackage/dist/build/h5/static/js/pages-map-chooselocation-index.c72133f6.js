(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-map-chooselocation-index"],{2781:function(t,e,n){"use strict";var a=n("fa9f"),i=n.n(a);i.a},"76ca":function(t,e,n){"use strict";n.r(e);var a=n("bb78"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},a15e:function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"location-wrapper"},[n("v-uni-view",{staticClass:"location-search"},[n("v-uni-input",{attrs:{type:"text",placeholder:"可输入检索位置"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.searchChange.apply(void 0,arguments)}},model:{value:t.searchContent,callback:function(e){t.searchContent=e},expression:"searchContent"}}),n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.searchContent,expression:"searchContent"}],staticClass:"clear",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clearSearchChange.apply(void 0,arguments)}}},[n("v-uni-image",{attrs:{mode:"widthFix",src:"/static/chooselocation/close-icon.png"}})],1)],1),n("v-uni-scroll-view",{staticClass:"location-list",attrs:{"scroll-y":!0},on:{scrolltolower:function(e){arguments[0]=e=t.$handleEvent(e),t.scrolltolower.apply(void 0,arguments)}}},[0===t.searchPointList.legnth?n("v-uni-view",{staticClass:"empty-data"},[t._v("暂无检索结果")]):t._e(),t._l(t.searchPointList,(function(e,a){return n("v-uni-view",{key:a,staticClass:"li",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.searchPointClick(a,e)}}},[n("v-uni-view",{staticClass:"point"},[n("v-uni-view",{staticClass:"name"},[t._v(t._s(e.name))]),n("v-uni-view",{staticClass:"address"},[t._v(t._s(e.address))])],1),n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.searchPointIndex===a,expression:"searchPointIndex === index"}],staticClass:"tag"})],1)}))],2),n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"loading-animation"},[n("v-uni-image",{attrs:{mode:"widthFix",src:"/static/chooselocation/loading-icon.png"}}),t._v("检索中")],1)],1)},r=[]},ad08:function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,".location-wrapper[data-v-4fb99b2e]{position:fixed;bottom:0;left:0;display:flex;flex-direction:column;width:100%;height:50vh}.location-search[data-v-4fb99b2e]{position:relative;flex-shrink:0;padding:%?20?%}.location-search uni-input[data-v-4fb99b2e]{padding:%?15?% %?70?% %?15?% %?20?%;background:#e5e5e5;border:%?1?% solid #e5e5e5;font-size:%?28?%;border-radius:%?10?%}.location-search .clear[data-v-4fb99b2e]{position:absolute;top:50%;right:%?40?%;display:flex;align-items:center;justify-content:center;width:%?30?%;height:%?30?%;border:%?2?% solid #fff;text-align:center;border-radius:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.location-search .clear uni-image[data-v-4fb99b2e]{width:%?20?%;height:%?20?%!important}.location-list[data-v-4fb99b2e]{overflow-y:auto;flex:1}.location-list .li[data-v-4fb99b2e]{display:flex;align-items:center;padding:%?20?%;border-top:%?1?% solid #e5e5e5;line-height:1.3}.location-list .li .point[data-v-4fb99b2e]{flex:1}.location-list .li .name[data-v-4fb99b2e]{margin-bottom:%?10?%;font-size:%?28?%}.location-list .li .address[data-v-4fb99b2e]{color:#999;font-size:%?24?%}.location-list .li .tag[data-v-4fb99b2e]{flex-shrink:0;width:%?30?%;height:%?30?%;margin-left:%?30?%;border:%?10?% solid #409eff;background:#fff;border-radius:50%;box-sizing:border-box}.empty-data[data-v-4fb99b2e]{padding:%?50?% 0;color:#999;font-size:%?28?%;text-align:center}.loading-animation[data-v-4fb99b2e]{position:fixed;bottom:0;left:0;z-index:1;display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:50%;background:hsla(0,0%,100%,.9);color:#999;font-size:%?28?%;text-align:center}.loading-animation uni-image[data-v-4fb99b2e]{width:%?60?%;height:%?60?%!important;margin-bottom:%?10?%;-webkit-animation:turn-data-v-4fb99b2e 1s linear infinite;animation:turn-data-v-4fb99b2e 1s linear infinite}@-webkit-keyframes turn-data-v-4fb99b2e{0%{-webkit-transform:rotate(0);transform:rotate(0)}25%{-webkit-transform:rotate(90deg);transform:rotate(90deg)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}75%{-webkit-transform:rotate(270deg);transform:rotate(270deg)}100%{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes turn-data-v-4fb99b2e{0%{-webkit-transform:rotate(0);transform:rotate(0)}25%{-webkit-transform:rotate(90deg);transform:rotate(90deg)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}75%{-webkit-transform:rotate(270deg);transform:rotate(270deg)}100%{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""]),t.exports=e},b85c:function(t,e,n){"use strict";n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;var a=i(n("06c5"));function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=(0,a.default)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(c)throw o}}}}},bb78:function(t,e,n){"use strict";var a=n("4ea4");n("b64b"),n("ac1f"),n("466d"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("b85c")),r={data:function(){return{systemInfo:uni.getSystemInfoSync(),StatusBar:null,Map:null,Marker:null,MapCloseButton:null,MapConfirmButton:null,MapCurrentButton:null,mapCurrentPoint:{},locationCurrent:{},searchType:1,searchContent:"",searchPointList:[],searchPointIndex:0,pageCurrent:1,loading:!1}},onLoad:function(){var t=this;plus.nativeUI.toast("当前地理位置读取中"),uni.getLocation({type:"gcj02",geocode:!0,success:function(e){t.mapCurrentPoint=e;var n=t.$mp.page.$getAppWebview();t.Map=plus.maps.create("map",{width:"100%",height:"50%",center:new plus.maps.Point(t.mapCurrentPoint.longitude,t.mapCurrentPoint.latitude),zoom:14}),n.append(t.Map),t.centerFunc(),t.markerFunc();var a=t.mapCurrentPoint.address.province+t.mapCurrentPoint.address.city+t.mapCurrentPoint.address.district+t.mapCurrentPoint.address.street+t.mapCurrentPoint.address.streetNum;t.locationCurrent={point:{longitude:t.mapCurrentPoint.longitude,latitude:t.mapCurrentPoint.latitude},name:t.mapCurrentPoint.address.poiName,address:a+t.mapCurrentPoint.address.poiName},t.searchPointChange(),t.Map.onclick=function(e){t.mapCurrentPoint=e,t.centerFunc(),t.markerFunc(),t.searchType=1,t.searchPointIndex=0,t.pageCurrent=1,plus.maps.Map.reverseGeocode(t.mapCurrentPoint,{coordType:"gcj02"},(function(e){t.locationCurrent={point:e.coord,name:"当前位置",address:e.address},t.searchPointChange()}),(function(t){plus.nativeUI.toast(JSON.stringify(t))}))}},fail:function(t){plus.nativeUI.toast("读取当前地理位置失败")}}),this.drawRectStatusBar(),this.drawRectClose(),this.drawRectConfirm(),this.drawRectCurrent()},methods:{centerFunc:function(){this.Map.setCenter(new plus.maps.Point(this.mapCurrentPoint.longitude,this.mapCurrentPoint.latitude))},markerFunc:function(){this.Map.removeOverlay(this.Marker),this.Marker=new plus.maps.Marker(new plus.maps.Point(this.mapCurrentPoint.longitude,this.mapCurrentPoint.latitude)),this.Marker.setIcon("/static/chooselocation/marker-icon.png"),this.Map.addOverlay(this.Marker)},searchChange:function(){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.searchContent?(t.locationCurrent={},t.searchType=0,t.searchPointIndex=void 0,t.pageCurrent=1,t.searchPointChange()):t.clearSearchChange()}),300)},clearSearchChange:function(){this.searchContent="",this.locationCurrentFunc()},scrolltolower:function(){this.pageCurrent++,this.searchPointChange()},searchPointChange:function(){var t=this,e=new plus.maps.Search(this.Map);0===this.searchType?e.poiSearchInbounds(this.searchContent,new plus.maps.Point(73.4,3.52),new plus.maps.Point(135.2,53.33),this.pageCurrent):e.poiSearchNearBy("",new plus.maps.Point(this.mapCurrentPoint.longitude,this.mapCurrentPoint.latitude),3e3,this.pageCurrent),this.loading=!0,e.onPoiSearchComplete=function(e,n){if(1===t.pageCurrent&&(t.searchPointList=[],Object.keys(t.locationCurrent).length>0&&t.searchPointList.push(t.locationCurrent)),0===e){var a=n.poiList;if(a.length>0){var r,o=(0,i.default)(a);try{var s=function(){var e=r.value;plus.maps.Map.geocode(e.address+e.name,{city:e.city},(function(n){var a,r=n.address.match(/.+?(省|市|区|自治区|自治州|县|乡|镇)/g),o="",s=(0,i.default)(r);try{for(s.s();!(a=s.n()).done;){var c=a.value;o+=c}}catch(u){s.e(u)}finally{s.f()}t.searchPointList.push({point:e.point,address:o+e.address+e.name,name:e.name})}))};for(o.s();!(r=o.n()).done;)s()}catch(c){o.e(c)}finally{o.f()}}else plus.nativeUI.toast("没有检索到结果")}else plus.nativeUI.toast("检索失败");t.loading=!1}},searchPointClick:function(t,e){this.searchPointIndex=t,this.mapCurrentPoint=e.point,this.centerFunc(),this.markerFunc()},drawRectStatusBar:function(){var t=new plus.nativeObj.View("statusbar",{height:"".concat(this.systemInfo.statusBarHeight,"px"),width:"100%"});t.drawRect({color:"rgba(0, 0, 0, .3)"}),t.show(),this.StatusBar=t},drawRectClose:function(){var t=new plus.nativeObj.View("close",{top:"".concat(this.systemInfo.statusBarHeight+10,"px"),left:"10px",height:"30px",width:"30px"});t.drawRect({color:"#999",radius:"8px"},{width:"100%",height:"100%"}),t.drawBitmap("/static/chooselocation/close-icon.png",{},{top:"7.5px",left:"7.5px",width:"15px",height:"15px"}),t.show(),this.MapCloseButton=t,t.addEventListener("click",(function(){uni.navigateBack()}),!1)},drawRectConfirm:function(){var t=this,e=new plus.nativeObj.View("confirm",{top:"".concat(this.systemInfo.statusBarHeight+10,"px"),left:"".concat(this.systemInfo.screenWidth-60,"px"),height:"30px",width:"50px"});e.drawRect({color:"#409eff",radius:"8px"},{width:"100%",height:"100%"}),e.drawText("确定",{},{color:"#fff",size:"14px"}),e.show(),this.MapConfirmButton=e,e.addEventListener("click",(function(){if(t.searchPointIndex||0===t.searchPointIndex){var e=t.searchPointList[t.searchPointIndex];delete e.name,uni.$emit("location",e),uni.navigateBack()}else plus.nativeUI.toast("请先选择地理位置")}),!1)},drawRectCurrent:function(){var t=this,e=new plus.nativeObj.View("center",{top:"43%",left:"".concat(this.systemInfo.screenWidth-40,"px"),height:"30px",width:"30px"});e.drawRect({color:"#999",radius:"30px"},{width:"100%",height:"100%"}),e.drawBitmap("/static/chooselocation/center-icon.png",{},{top:"5px",left:"5px",width:"20px",height:"20px"}),e.show(),this.MapCurrentButton=e,e.addEventListener("click",(function(){t.locationCurrentFunc()}),!1)},locationCurrentFunc:function(){var t=this;uni.getLocation({type:"gcj02",geocode:!0,success:function(e){t.mapCurrentPoint=e,t.centerFunc(),t.markerFunc(),t.searchType=1,t.searchPointIndex=0,t.pageCurrent=1;var n=t.mapCurrentPoint.address.province+t.mapCurrentPoint.address.city+t.mapCurrentPoint.address.district+t.mapCurrentPoint.address.street+t.mapCurrentPoint.address.streetNum;t.locationCurrent={point:{longitude:t.mapCurrentPoint.longitude,latitude:t.mapCurrentPoint.latitude},name:t.mapCurrentPoint.address.poiName,address:n+t.mapCurrentPoint.address.poiName},t.searchPointChange()},fail:function(t){plus.nativeUI.toast("读取当前地理位置失败")}})}},onUnload:function(){this.StatusBar.close(),this.MapCloseButton.close(),this.MapConfirmButton.close(),this.MapCurrentButton.close(),this.Map.close()}};e.default=r},e6d7:function(t,e,n){"use strict";n.r(e);var a=n("a15e"),i=n("76ca");for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("2781");var o,s=n("f0c5"),c=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"4fb99b2e",null,!1,a["a"],o);e["default"]=c.exports},fa9f:function(t,e,n){var a=n("ad08");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("11e35e30",a,!0,{sourceMap:!1,shadowMode:!1})}}]);